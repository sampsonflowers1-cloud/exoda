<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<title>Έξοδα Μαγαζιού</title>
<style>
body{
font-family: Arial;
background:#f5f5f5;
padding:20px;
}
h1{
text-align:center;
}
.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
gap:10px;
margin-top:20px;
}
button{
padding:20px;
font-size:14px;
border:none;
background:#1976d2;
color:white;
border-radius:8px;
cursor:pointer;
}
button:hover{
background:#125aa0;
}
</style>
</head>
<body>

<h1>Έξοδα Μαγαζιού</h1>
<div class="grid" id="grid"></div>

<script>
const TOTAL = 30;

// names = τα ονόματα που θα φαίνονται στα κουμπιά
let names = JSON.parse(localStorage.getItem("exoda_names") || "null");

// αν δεν υπάρχουν ονόματα, φτιάχνει τα default (Προμηθευτής 1..30)
if (!Array.isArray(names) || names.length !== TOTAL) {
  names = [];
  for (let i = 1; i <= TOTAL; i++) names.push("Προμηθευτής " + i);
  localStorage.setItem("exoda_names", JSON.stringify(names));
}


const grid=document.getElementById("grid");
let data=JSON.parse(localStorage.getItem("exoda")||"{}");

names.forEach(name=>{
if(!data[name]) data[name]=[];

const btn=document.createElement("button");
btn.textContent=name;
// Δεξί κλικ = Μετονομασία
btn.oncontextmenu = (e) => {
  e.preventDefault();

  const newName = prompt("Νέο όνομα για: " + name, name);
  if (!newName) return;

  const clean = newName.trim();
  if (!clean) return;

  // έλεγχος να μην υπάρχει ήδη ίδιο όνομα
  if (names.includes(clean) && clean !== name) {
    alert("Υπάρχει ήδη αυτό το όνομα.");
    return;
  }

  // μεταφορά ιστορικού (τα λεφτά) από παλιό όνομα σε νέο
  if (data[name] && name !== clean) {
    data[clean] = data[name];
    delete data[name];
    localStorage.setItem("exoda", JSON.stringify(data));
  }

  // αλλαγή ονόματος στη λίστα κουμπιών
  const idx = names.indexOf(name);
  if (idx !== -1) {
    names[idx] = clean;
    localStorage.setItem("exoda_names", JSON.stringify(names));
  }

  location.reload(); // ανανέωση για να φανούν τα νέα ονόματα
};

btn.onclick=()=>{
let history = "";
let total = 0;

if(data[name].length > 0){
    history += "Προηγούμενα:\n";
    data[name].forEach(item => {
        history += item.date + " - " + item.amount + "€\n";
        total += Number(item.amount);
    });
    history += "\nΣύνολο: " + total + "€\n\n";
}



let amount = prompt(
"Ποσό για " + name + "\n\nΙστορικό:\n" + history + "\nΝέο ποσό:"
);


if(!amount) return;
let date=new Date().toISOString().slice(0,10);
data[name].push({amount:parseFloat(amount),date:date});
localStorage.setItem("exoda",JSON.stringify(data));
};

grid.appendChild(btn);
});
</script>

</body>
</html>


